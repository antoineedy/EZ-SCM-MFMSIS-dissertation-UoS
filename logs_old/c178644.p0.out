[i 0801 11:03:01.900695 08 lock.py:85] Create lock file:/user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/jittor.lock
[i 0801 11:03:01.900740 92 lock.py:85] Create lock file:/user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/jittor.lock
[i 0801 11:03:01.900766 64 lock.py:85] Create lock file:/user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/jittor.lock
[i 0801 11:03:01.904621 64 lock.py:85] Create lock file:/user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/jittor.lock
[i 0801 11:03:01.939094 08 compiler.py:956] Jittor(1.3.8.5) src: /mnt/fast/nobackup/scratch4weeks/ae01116/zegenv/lib/python3.9/site-packages/jittor
[i 0801 11:03:01.942926 08 compiler.py:957] g++ at /usr/bin/g++(7.5.0)
[i 0801 11:03:01.943024 08 compiler.py:958] cache_path: /user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/default
[i 0801 11:03:01.949412 08 __init__.py:411] Found nvcc(11.0.221) at /usr/local/cuda/bin/nvcc.
[i 0801 11:03:01.955252 08 __init__.py:411] Found addr2line(2.30) at /usr/bin/addr2line.
[i 0801 11:03:02.089893 08 compiler.py:1011] cuda key:cu11.0.221_sm_86
[i 0801 11:03:02.128034 08 compiler.py:34] Create cache dir: /user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/default/cu11.0.221_sm_86
[i 0801 11:03:02.130568 08 compiler.py:34] Create cache dir: /user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/default/cu11.0.221_sm_86/jit
[i 0801 11:03:02.131997 08 compiler.py:34] Create cache dir: /user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/default/cu11.0.221_sm_86/obj_files
[i 0801 11:03:02.133628 08 compiler.py:34] Create cache dir: /user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/default/cu11.0.221_sm_86/gen
[i 0801 11:03:02.135244 08 compiler.py:34] Create cache dir: /user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/default/cu11.0.221_sm_86/tmp
[i 0801 11:03:02.136776 08 compiler.py:34] Create cache dir: /user/HS400/ae01116/.cache/jittor/jt1.3.8/g++7.5.0/py3.9.19/Linux-4.18.0-4xf5/AMDEPYC753232-x73/default/cu11.0.221_sm_86/checkpoints
Compiling jittor_core(24/151) used: 2.024s eta: 10.712sCompiling jittor_core(25/151) used: 2.036s eta: 10.262sCompiling jittor_core(26/151) used: 2.085s eta: 10.024sCompiling jittor_core(27/151) used: 2.246s eta: 10.313sCompiling jittor_core(28/151) used: 2.275s eta: 9.995sCompiling jittor_core(29/151) used: 2.284s eta: 9.607sCompiling jittor_core(30/151) used: 2.537s eta: 10.231sCompiling jittor_core(31/151) used: 2.576s eta: 9.973sCompiling jittor_core(32/151) used: 2.623s eta: 9.756sCompiling jittor_core(33/151) used: 2.682s eta: 9.589sCompiling jittor_core(34/151) used: 2.828s eta: 9.731sCompiling jittor_core(35/151) used: 3.018s eta: 10.002sCompiling jittor_core(36/151) used: 3.081s eta: 9.842sCompiling jittor_core(37/151) used: 3.112s eta: 9.588sCompiling jittor_core(38/151) used: 3.134s eta: 9.320sCompiling jittor_core(39/151) used: 3.210s eta: 9.218sCompiling jittor_core(40/151) used: 3.310s eta: 9.185sCompiling jittor_core(41/151) used: 3.329s eta: 8.931sCompiling jittor_core(42/151) used: 3.331s eta: 8.645sCompiling jittor_core(43/151) used: 3.535s eta: 8.878sCompiling jittor_core(44/151) used: 3.590s eta: 8.730sCompiling jittor_core(45/151) used: 3.590s eta: 8.457sCompiling jittor_core(46/151) used: 3.808s eta: 8.693sCompiling jittor_core(47/151) used: 3.832s eta: 8.479sCompiling jittor_core(48/151) used: 3.890s eta: 8.348sCompiling jittor_core(49/151) used: 3.966s eta: 8.255sCompiling jittor_core(50/151) used: 4.173s eta: 8.430sCompiling jittor_core(51/151) used: 4.177s eta: 8.191sCompiling jittor_core(52/151) used: 4.197s eta: 7.990sCompiling jittor_core(53/151) used: 4.291s eta: 7.934sCompiling jittor_core(54/151) used: 4.354s eta: 7.820sCompiling jittor_core(55/151) used: 4.440s eta: 7.751sCompiling jittor_core(56/151) used: 4.480s eta: 7.600sCompiling jittor_core(57/151) used: 4.594s eta: 7.576sCompiling jittor_core(58/151) used: 4.686s eta: 7.513sCompiling jittor_core(59/151) used: 4.733s eta: 7.380sCompiling jittor_core(60/151) used: 4.785s eta: 7.258sCompiling jittor_core(61/151) used: 4.789s eta: 7.065sCompiling jittor_core(62/151) used: 4.900s eta: 7.034sCompiling jittor_core(63/151) used: 4.908s eta: 6.856sCompiling jittor_core(64/151) used: 5.064s eta: 6.884sCompiling jittor_core(65/151) used: 5.195s eta: 6.873sCompiling jittor_core(66/151) used: 5.196s eta: 6.692sCompiling jittor_core(67/151) used: 5.253s eta: 6.586sCompiling jittor_core(68/151) used: 5.294s eta: 6.461sCompiling jittor_core(69/151) used: 5.296s eta: 6.294sCompiling jittor_core(70/151) used: 5.409s eta: 6.260sCompiling jittor_core(71/151) used: 5.478s eta: 6.172sCompiling jittor_core(72/151) used: 5.503s eta: 6.038sCompiling jittor_core(73/151) used: 5.507s eta: 5.885sCompiling jittor_core(74/151) used: 5.521s eta: 5.745sCompiling jittor_core(75/151) used: 5.549s eta: 5.623sCompiling jittor_core(76/151) used: 5.602s eta: 5.528sCompiling jittor_core(77/151) used: 5.688s eta: 5.467sCompiling jittor_core(78/151) used: 5.773s eta: 5.403sCompiling jittor_core(79/151) used: 5.796s eta: 5.282sCompiling jittor_core(80/151) used: 5.894s eta: 5.231sCompiling jittor_core(81/151) used: 5.919s eta: 5.115sCompiling jittor_core(82/151) used: 5.955s eta: 5.011sCompiling jittor_core(83/151) used: 5.985s eta: 4.903sCompiling jittor_core(84/151) used: 6.129s eta: 4.889sCompiling jittor_core(85/151) used: 6.325s eta: 4.911sCompiling jittor_core(86/151) used: 6.341s eta: 4.792sCompiling jittor_core(87/151) used: 6.447s eta: 4.742sCompiling jittor_core(88/151) used: 6.513s eta: 4.663sCompiling jittor_core(89/151) used: 6.582s eta: 4.585sCompiling jittor_core(90/151) used: 6.610s eta: 4.480sCompiling jittor_core(91/151) used: 6.691s eta: 4.412sCompiling jittor_core(92/151) used: 6.784s eta: 4.350sCompiling jittor_core(93/151) used: 6.840s eta: 4.266sCompiling jittor_core(94/151) used: 6.847s eta: 4.152sCompiling jittor_core(95/151) used: 6.864s eta: 4.046sCompiling jittor_core(96/151) used: 6.952s eta: 3.983sCompiling jittor_core(97/151) used: 7.081s eta: 3.942sCompiling jittor_core(98/151) used: 7.178s eta: 3.882sCompiling jittor_core(99/151) used: 7.203s eta: 3.784sCompiling jittor_core(100/151) used: 7.222s eta: 3.683sCompiling jittor_core(101/151) used: 7.242s eta: 3.585sCompiling jittor_core(102/151) used: 7.260s eta: 3.488sCompiling jittor_core(103/151) used: 7.490s eta: 3.491sCompiling jittor_core(104/151) used: 7.595s eta: 3.432sCompiling jittor_core(105/151) used: 7.708s eta: 3.377sCompiling jittor_core(106/151) used: 7.778s eta: 3.302sCompiling jittor_core(107/151) used: 7.834s eta: 3.222sCompiling jittor_core(108/151) used: 7.836s eta: 3.120sCompiling jittor_core(109/151) used: 7.960s eta: 3.067sCompiling jittor_core(110/151) used: 8.004s eta: 2.983sCompiling jittor_core(111/151) used: 8.005s eta: 2.885sCompiling jittor_core(112/151) used: 8.058s eta: 2.806sCompiling jittor_core(113/151) used: 8.063s eta: 2.711sCompiling jittor_core(114/151) used: 8.099s eta: 2.629sCompiling jittor_core(115/151) used: 8.353s eta: 2.615sCompiling jittor_core(116/151) used: 8.354s eta: 2.521sCompiling jittor_core(117/151) used: 8.385s eta: 2.437sCompiling jittor_core(118/151) used: 8.476s eta: 2.370sCompiling jittor_core(119/151) used: 8.567s eta: 2.304sCompiling jittor_core(120/151) used: 8.630s eta: 2.229sCompiling jittor_core(121/151) used: 8.761s eta: 2.172sCompiling jittor_core(122/151) used: 8.811s eta: 2.094sCompiling jittor_core(123/151) used: 8.812s eta: 2.006sCompiling jittor_core(124/151) used: 8.910s eta: 1.940sCompiling jittor_core(125/151) used: 9.026s eta: 1.877sCompiling jittor_core(126/151) used: 9.052s eta: 1.796sCompiling jittor_core(127/151) used: 9.079s eta: 1.716sCompiling jittor_core(128/151) used: 9.223s eta: 1.657sCompiling jittor_core(129/151) used: 9.301s eta: 1.586sCompiling jittor_core(130/151) used: 9.301s eta: 1.503sCompiling jittor_core(131/151) used: 9.304s eta: 1.420sCompiling jittor_core(132/151) used: 9.319s eta: 1.341sCompiling jittor_core(133/151) used: 9.333s eta: 1.263sCompiling jittor_core(134/151) used: 9.357s eta: 1.187sCompiling jittor_core(135/151) used: 9.378s eta: 1.112sCompiling jittor_core(136/151) used: 9.522s eta: 1.050sCompiling jittor_core(137/151) used: 9.578s eta: 0.979sCompiling jittor_core(138/151) used: 9.620s eta: 0.906sCompiling jittor_core(139/151) used: 9.644s eta: 0.833sCompiling jittor_core(140/151) used: 9.716s eta: 0.763sCompiling jittor_core(141/151) used: 9.789s eta: 0.694sCompiling jittor_core(142/151) used: 9.793s eta: 0.621sCompiling jittor_core(143/151) used: 9.910s eta: 0.554sCompiling jittor_core(144/151) used: 10.048s eta: 0.488sCompiling jittor_core(145/151) used: 10.143s eta: 0.420sCompiling jittor_core(146/151) used: 10.183s eta: 0.349sCompiling jittor_core(147/151) used: 10.224s eta: 0.278sCompiling jittor_core(148/151) used: 10.970s eta: 0.222sCompiling jittor_core(149/151) used: 11.330s eta: 0.152sCompiling jittor_core(150/151) used: 11.722s eta: 0.078sCompiling jittor_core(151/151) used: 17.887s eta: 0.000s
Compiling libcutt(8/9) used: 3.766s eta: 0.471sCompiling libcutt(9/9) used: 7.915s eta: 0.000s
Compiling gen_ops_mkl_conv_mkl_conv_backward_w_mkl_test_mkl____hash4cc03b(7/7) used: 2.325s eta: 0.000s
Compiling gen_ops_cudnn_rnn_cudnn_conv_backward_w_cudnn_conv___hash8b3aa2(16/16) used: 3.324s eta: 0.000s
Torch cache cleared
Loading config from:  /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos/configs/voc12/clip_rc_zero_vit-b_512x512_40k_voc_10_16.py
Torch cache cleared
Loading config from:  /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos/configs/voc12/clip_rc_zero_vit-b_512x512_40k_voc_10_16.py
Torch cache cleared
Loading config from:  /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos/configs/voc12/clip_rc_zero_vit-b_512x512_40k_voc_10_16.py
Torch cache cleared
Loading config from:  /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos/configs/voc12/clip_rc_zero_vit-b_512x512_40k_voc_10_16.py
Resize the pos_embed shape from (197, 768) to [1025,768,]
Resize the pos_embed shape from (197, 768) to [1025,768,]
Resize the pos_embed shape from (197, 768) to [1025,768,]
Resize the pos_embed shape from (197, 768) to [1025,768,]
Making visible mask for zero-shot setting: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1 255]
--------------------------------------
Finetune layer in segmentor: backbone.prompt_embeddings
Finetune layer in segmentor: backbone.deep_prompt_embeddings
Finetune layer in segmentor: backbone.prompt_proj.weight
Finetune layer in segmentor: backbone.prompt_proj.bias
Finetune layer in segmentor: backbone.prompt_norm.weight
Finetune layer in segmentor: backbone.prompt_norm.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.linear1.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.linear2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm2.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm3.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm3.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.linear1.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.linear2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm2.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm3.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm3.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_q_in.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_k_in.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_q_out.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_k_out.bias
Finetune layer in segmentor: decode_head.lateral_proj.bias
Finetune layer in segmentor: decode_head.q_proj.bias
CLASSES: &id003 !!python/tuple
- aeroplane
- bicycle
- bird
- boat
- bottle
- bus
- car
- cat
- chair
- cow
- diningtable
- dog
- horse
- motorbike
- person
- pottedplant
- sheep
- sofa
- train
- tvmonitor
base: /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos
base_class:
- 0
- 1
- 2
- 3
- 4
- 5
- 6
- 7
- 8
- 9
- 10
- 11
- 12
- 13
- 14
base_scratch: /mnt/fast/nobackup/scratch4weeks/ae01116
both_class:
- 0
- 1
- 2
- 3
- 4
- 5
- 6
- 7
- 8
- 9
- 10
- 11
- 12
- 13
- 14
- 15
- 16
- 17
- 18
- 19
checkpoint_interval: 2000
crop_size: &id002 !!python/tuple
- 512
- 512
data:
  samples_per_gpu: 4
  test:
    ann_dir: SegmentationClass
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - flip: false
      img_scale: &id001 !!python/tuple
      - 2048
      - 512
      transforms:
      - keep_ratio: true
        min_size: 512
        type: Resize
      - type: RandomFlip
      - mean:
        - 123.675
        - 116.28
        - 103.53
        std:
        - 58.395
        - 57.12
        - 57.375
        to_rgb: true
        type: Normalize
      - keys:
        - img
        type: ImageToTensor
      - keys:
        - img
        type: Collect
      type: MultiScaleFlipAug
    split: ImageSets/Segmentation/val.txt
    type: ZeroPascalVOCDataset20
  train:
    ann_dir:
    - SegmentationClass
    - SegmentationClassAug
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - reduce_zero_label: true
      type: LoadAnnotations
    - img_scale: *id001
      ratio_range: &id004 !!python/tuple
      - 0.5
      - 2.0
      type: Resize
    - cat_max_ratio: 0.75
      crop_size: *id002
      type: RandomCrop
    - prob: 0.5
      type: RandomFlip
    - type: PhotoMetricDistortion
    - mean:
      - 123.675
      - 116.28
      - 103.53
      std:
      - 58.395
      - 57.12
      - 57.375
      to_rgb: true
      type: Normalize
    - pad_val: 0
      seg_pad_val: 255
      size: *id002
      type: Pad
    - type: DefaultFormatBundle
    - keys:
      - img
      - gt_semantic_seg
      type: Collect
    split:
    - ImageSets/Segmentation/train.txt
    - ImageSets/Segmentation/aug.txt
    type: ZeroPascalVOCDataset20
  val:
    ann_dir: SegmentationClass
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - flip: false
      img_scale: *id001
      transforms:
      - keep_ratio: true
        min_size: 512
        type: Resize
      - type: RandomFlip
      - mean:
        - 123.675
        - 116.28
        - 103.53
        std:
        - 58.395
        - 57.12
        - 57.375
        to_rgb: true
        type: Normalize
      - keys:
        - img
        type: ImageToTensor
      - keys:
        - img
        type: Collect
      type: MultiScaleFlipAug
    split: ImageSets/Segmentation/val.txt
    type: ZeroPascalVOCDataset20
  workers_per_gpu: 4
data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
dataset_type: ZeroPascalVOCDataset20
eval_interval: 2000
img_norm_cfg:
  mean:
  - 123.675
  - 116.28
  - 103.53
  std:
  - 58.395
  - 57.12
  - 57.375
  to_rgb: true
img_size: 512
in_channels: 512
log_interval: 50
logger:
  type: RunLogger
max_iter: 40000
model:
  backbone:
    drop_path_rate: 0.1
    get_embeddings: true
    input_resolution: 512
    layers: 12
    num_tokens: 10
    out_indices:
    - 11
    output_dim: 512
    patch_size: 16
    prompt_dim: 768
    region_level_bridge_size: 16
    total_d_layer: 11
    type: CLIPVisionTransformerWithRLB
    width: 768
  base_class:
  - 0
  - 1
  - 2
  - 3
  - 4
  - 5
  - 6
  - 7
  - 8
  - 9
  - 10
  - 11
  - 12
  - 13
  - 14
  both_class:
  - 0
  - 1
  - 2
  - 3
  - 4
  - 5
  - 6
  - 7
  - 8
  - 9
  - 10
  - 11
  - 12
  - 13
  - 14
  - 15
  - 16
  - 17
  - 18
  - 19
  class_names: *id003
  decode_head:
    all_idx:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    - 6
    - 7
    - 8
    - 9
    - 10
    - 11
    - 12
    - 13
    - 14
    - 15
    - 16
    - 17
    - 18
    - 19
    channels: 512
    embed_dims: 512
    img_size: 512
    in_channels: 512
    num_classes: 15
    num_heads: 8
    num_layers: 3
    seen_idx:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    - 6
    - 7
    - 8
    - 9
    - 10
    - 11
    - 12
    - 13
    - 14
    type: ATMSingleHeadSeg
    use_proj: false
    use_stages: 1
  exclude_key: prompt
  ft_backbone: false
  load_text_embedding: /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos/configs/_base_/datasets/text_embedding/voc12_single.npy
  novel_class:
  - 15
  - 16
  - 17
  - 18
  - 19
  pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
  pretrained_text: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
  test_cfg:
    crop_size: !!python/tuple
    - 512
    - 512
    mode: slide
    stride: !!python/tuple
    - 426
    - 426
  text_encoder:
    context_length: 77
    embed_dim: 512
    pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
    transformer_heads: 8
    transformer_layers: 12
    transformer_width: 512
    type: CLIPTextEncoder
  type: CLIPRC
name: clip_rc_zero_vit-b_512x512_40k_voc_10_16
novel_class:
- 15
- 16
- 17
- 18
- 19
optimizer:
  betas: !!python/tuple
  - 0.9
  - 0.999
  lr: 2.0e-05
  type: CustomAdamW
  weight_decay: 0.01
out_indices:
- 11
parameter_groups_generator:
  custom_keys:
    backbone:
      lr_mult: 10.0
    head:
      lr_mult: 10.0
    ln:
      decay_mult: 0.0
    norm:
      decay_mult: 0.0
    text_encoder:
      lr_mult: 0.0
  type: CustomPrameterGroupsGenerator
pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
region_level_bridge_size: 16
scheduler:
  max_steps: 40000
  min_lr: 1.0e-06
  power: 0.9
  type: PolyLR
  warmup: linear
  warmup_iters: 1500
  warmup_ratio: 1.0e-06
test_pipeline:
- type: LoadImageFromFile
- flip: false
  img_scale: *id001
  transforms:
  - keep_ratio: true
    min_size: 512
    type: Resize
  - type: RandomFlip
  - mean:
    - 123.675
    - 116.28
    - 103.53
    std:
    - 58.395
    - 57.12
    - 57.375
    to_rgb: true
    type: Normalize
  - keys:
    - img
    type: ImageToTensor
  - keys:
    - img
    type: Collect
  type: MultiScaleFlipAug
train_pipeline:
- type: LoadImageFromFile
- reduce_zero_label: true
  type: LoadAnnotations
- img_scale: *id001
  ratio_range: *id004
  type: Resize
- cat_max_ratio: 0.75
  crop_size: *id002
  type: RandomCrop
- prob: 0.5
  type: RandomFlip
- type: PhotoMetricDistortion
- mean:
  - 123.675
  - 116.28
  - 103.53
  std:
  - 58.395
  - 57.12
  - 57.375
  to_rgb: true
  type: Normalize
- pad_val: 0
  seg_pad_val: 255
  size: *id002
  type: Pad
- type: DefaultFormatBundle
- keys:
  - img
  - gt_semantic_seg
  type: Collect
work_dir: work_dirs/clip_rc_zero_vit-b_512x512_40k_voc_10_16

Making visible mask for zero-shot setting: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1 255]
--------------------------------------
Thu Aug  1 11:04:57 2024  model:CLIPRC(
    backbone: CLIPVisionTransformerWithRLB(
        conv1: Conv(3, 768, (16, 16), (16, 16), (0, 0), (1, 1), 1, None, None, Kw=None, fan=None, i=None, bound=None)
        ln_pre: LayerNorm((768,), 1e-05, elementwise_affine=True)
        transformer: Transformer(
            resblocks: Sequential(
                0: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                1: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.00909090880304575)
                )
                2: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.0181818176060915)
                )
                3: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.027272727340459824)
                )
                4: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.036363635212183)
                )
                5: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.045454543083906174)
                )
                6: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.05454545468091965)
                )
                7: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.06363636255264282)
                )
                8: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.072727270424366)
                )
                9: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.08181817829608917)
                )
                10: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.09090908616781235)
                )
                11: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.09999999403953552)
                )
            )
        )
        ln_post: LayerNorm((768,), 1e-05, elementwise_affine=True)
        prompt_proj: Linear(768, 768, float32[768,], None)
        prompt_norm: LayerNorm((768,), 1e-06, elementwise_affine=True)
        prompt_dropout: Dropout(0.1, is_train=False)
    )
    decode_head: ATMSingleHeadSeg(
        loss_decode: CrossEntropyLoss(avg_non_ignore=False)
        dropout: Dropout(0.1, is_train=False)
        input_proj_1: Identity(None, None)
        proj_norm_1: Identity(None, None)
        decoder_q: TPN_Decoder(
            layers: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                1: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                2: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
        )
        decoder_v: TPN_Decoder(
            layers: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                1: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                2: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
        )
        recovery_decoder: RecoveryDecoder(
            decouple_q: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
            decouple_v: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
            linear_q_in: Linear(512, 512, float32[512,], None)
            linear_k_in: Linear(512, 512, float32[512,], None)
            linear_q_out: Linear(512, 1024, float32[1024,], None)
            linear_k_out: Linear(512, 512, float32[512,], None)
        )
        lateral_proj: Linear(1536, 512, float32[512,], None)
        q_proj: Linear(1024, 512, float32[512,], None)
    )
    text_encoder: CLIPTextEncoder(
        transformer: Transformer(
            resblocks: Sequential(
                0: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                1: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                2: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                3: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                4: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                5: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                6: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                7: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                8: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                9: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                10: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                11: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
            )
        )
        token_embedding: Embedding(49408, 512, None, dtype=None)
        ln_final: LayerNorm((512,), 1e-05, elementwise_affine=True)
    )
)
Finetune layer in segmentor: backbone.prompt_embeddings
Finetune layer in segmentor: backbone.deep_prompt_embeddings
Finetune layer in segmentor: backbone.prompt_proj.weight
Finetune layer in segmentor: backbone.prompt_proj.bias
Finetune layer in segmentor: backbone.prompt_norm.weight
Finetune layer in segmentor: backbone.prompt_norm.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.linear1.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.linear2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm2.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm3.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm3.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.linear1.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.linear2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm2.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm3.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm3.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_q_in.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_k_in.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_q_out.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_k_out.bias
Finetune layer in segmentor: decode_head.lateral_proj.bias
Finetune layer in segmentor: decode_head.q_proj.bias
CLASSES: &id003 !!python/tuple
- aeroplane
- bicycle
- bird
- boat
- bottle
- bus
- car
- cat
- chair
- cow
- diningtable
- dog
- horse
- motorbike
- person
- pottedplant
- sheep
- sofa
- train
- tvmonitor
base: /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos
base_class:
- 0
- 1
- 2
- 3
- 4
- 5
- 6
- 7
- 8
- 9
- 10
- 11
- 12
- 13
- 14
base_scratch: /mnt/fast/nobackup/scratch4weeks/ae01116
both_class:
- 0
- 1
- 2
- 3
- 4
- 5
- 6
- 7
- 8
- 9
- 10
- 11
- 12
- 13
- 14
- 15
- 16
- 17
- 18
- 19
checkpoint_interval: 2000
crop_size: &id002 !!python/tuple
- 512
- 512
data:
  samples_per_gpu: 4
  test:
    ann_dir: SegmentationClass
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - flip: false
      img_scale: &id001 !!python/tuple
      - 2048
      - 512
      transforms:
      - keep_ratio: true
        min_size: 512
        type: Resize
      - type: RandomFlip
      - mean:
        - 123.675
        - 116.28
        - 103.53
        std:
        - 58.395
        - 57.12
        - 57.375
        to_rgb: true
        type: Normalize
      - keys:
        - img
        type: ImageToTensor
      - keys:
        - img
        type: Collect
      type: MultiScaleFlipAug
    split: ImageSets/Segmentation/val.txt
    type: ZeroPascalVOCDataset20
  train:
    ann_dir:
    - SegmentationClass
    - SegmentationClassAug
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - reduce_zero_label: true
      type: LoadAnnotations
    - img_scale: *id001
      ratio_range: &id004 !!python/tuple
      - 0.5
      - 2.0
      type: Resize
    - cat_max_ratio: 0.75
      crop_size: *id002
      type: RandomCrop
    - prob: 0.5
      type: RandomFlip
    - type: PhotoMetricDistortion
    - mean:
      - 123.675
      - 116.28
      - 103.53
      std:
      - 58.395
      - 57.12
      - 57.375
      to_rgb: true
      type: Normalize
    - pad_val: 0
      seg_pad_val: 255
      size: *id002
      type: Pad
    - type: DefaultFormatBundle
    - keys:
      - img
      - gt_semantic_seg
      type: Collect
    split:
    - ImageSets/Segmentation/train.txt
    - ImageSets/Segmentation/aug.txt
    type: ZeroPascalVOCDataset20
  val:
    ann_dir: SegmentationClass
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - flip: false
      img_scale: *id001
      transforms:
      - keep_ratio: true
        min_size: 512
        type: Resize
      - type: RandomFlip
      - mean:
        - 123.675
        - 116.28
        - 103.53
        std:
        - 58.395
        - 57.12
        - 57.375
        to_rgb: true
        type: Normalize
      - keys:
        - img
        type: ImageToTensor
      - keys:
        - img
        type: Collect
      type: MultiScaleFlipAug
    split: ImageSets/Segmentation/val.txt
    type: ZeroPascalVOCDataset20
  workers_per_gpu: 4
data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
dataset_type: ZeroPascalVOCDataset20
eval_interval: 2000
img_norm_cfg:
  mean:
  - 123.675
  - 116.28
  - 103.53
  std:
  - 58.395
  - 57.12
  - 57.375
  to_rgb: true
img_size: 512
in_channels: 512
log_interval: 50
logger:
  type: RunLogger
max_iter: 40000
model:
  backbone:
    drop_path_rate: 0.1
    get_embeddings: true
    input_resolution: 512
    layers: 12
    num_tokens: 10
    out_indices:
    - 11
    output_dim: 512
    patch_size: 16
    prompt_dim: 768
    region_level_bridge_size: 16
    total_d_layer: 11
    type: CLIPVisionTransformerWithRLB
    width: 768
  base_class:
  - 0
  - 1
  - 2
  - 3
  - 4
  - 5
  - 6
  - 7
  - 8
  - 9
  - 10
  - 11
  - 12
  - 13
  - 14
  both_class:
  - 0
  - 1
  - 2
  - 3
  - 4
  - 5
  - 6
  - 7
  - 8
  - 9
  - 10
  - 11
  - 12
  - 13
  - 14
  - 15
  - 16
  - 17
  - 18
  - 19
  class_names: *id003
  decode_head:
    all_idx:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    - 6
    - 7
    - 8
    - 9
    - 10
    - 11
    - 12
    - 13
    - 14
    - 15
    - 16
    - 17
    - 18
    - 19
    channels: 512
    embed_dims: 512
    img_size: 512
    in_channels: 512
    num_classes: 15
    num_heads: 8
    num_layers: 3
    seen_idx:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    - 6
    - 7
    - 8
    - 9
    - 10
    - 11
    - 12
    - 13
    - 14
    type: ATMSingleHeadSeg
    use_proj: false
    use_stages: 1
  exclude_key: prompt
  ft_backbone: false
  load_text_embedding: /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos/configs/_base_/datasets/text_embedding/voc12_single.npy
  novel_class:
  - 15
  - 16
  - 17
  - 18
  - 19
  pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
  pretrained_text: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
  test_cfg:
    crop_size: !!python/tuple
    - 512
    - 512
    mode: slide
    stride: !!python/tuple
    - 426
    - 426
  text_encoder:
    context_length: 77
    embed_dim: 512
    pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
    transformer_heads: 8
    transformer_layers: 12
    transformer_width: 512
    type: CLIPTextEncoder
  type: CLIPRC
name: clip_rc_zero_vit-b_512x512_40k_voc_10_16
novel_class:
- 15
- 16
- 17
- 18
- 19
optimizer:
  betas: !!python/tuple
  - 0.9
  - 0.999
  lr: 2.0e-05
  type: CustomAdamW
  weight_decay: 0.01
out_indices:
- 11
parameter_groups_generator:
  custom_keys:
    backbone:
      lr_mult: 10.0
    head:
      lr_mult: 10.0
    ln:
      decay_mult: 0.0
    norm:
      decay_mult: 0.0
    text_encoder:
      lr_mult: 0.0
  type: CustomPrameterGroupsGenerator
pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
region_level_bridge_size: 16
scheduler:
  max_steps: 40000
  min_lr: 1.0e-06
  power: 0.9
  type: PolyLR
  warmup: linear
  warmup_iters: 1500
  warmup_ratio: 1.0e-06
test_pipeline:
- type: LoadImageFromFile
- flip: false
  img_scale: *id001
  transforms:
  - keep_ratio: true
    min_size: 512
    type: Resize
  - type: RandomFlip
  - mean:
    - 123.675
    - 116.28
    - 103.53
    std:
    - 58.395
    - 57.12
    - 57.375
    to_rgb: true
    type: Normalize
  - keys:
    - img
    type: ImageToTensor
  - keys:
    - img
    type: Collect
  type: MultiScaleFlipAug
train_pipeline:
- type: LoadImageFromFile
- reduce_zero_label: true
  type: LoadAnnotations
- img_scale: *id001
  ratio_range: *id004
  type: Resize
- cat_max_ratio: 0.75
  crop_size: *id002
  type: RandomCrop
- prob: 0.5
  type: RandomFlip
- type: PhotoMetricDistortion
- mean:
  - 123.675
  - 116.28
  - 103.53
  std:
  - 58.395
  - 57.12
  - 57.375
  to_rgb: true
  type: Normalize
- pad_val: 0
  seg_pad_val: 255
  size: *id002
  type: Pad
- type: DefaultFormatBundle
- keys:
  - img
  - gt_semantic_seg
  type: Collect
work_dir: work_dirs/clip_rc_zero_vit-b_512x512_40k_voc_10_16

Thu Aug  1 11:04:57 2024  model:CLIPRC(
    backbone: CLIPVisionTransformerWithRLB(
        conv1: Conv(3, 768, (16, 16), (16, 16), (0, 0), (1, 1), 1, None, None, Kw=None, fan=None, i=None, bound=None)
        ln_pre: LayerNorm((768,), 1e-05, elementwise_affine=True)
        transformer: Transformer(
            resblocks: Sequential(
                0: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                1: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.00909090880304575)
                )
                2: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.0181818176060915)
                )
                3: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.027272727340459824)
                )
                4: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.036363635212183)
                )
                5: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.045454543083906174)
                )
                6: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.05454545468091965)
                )
                7: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.06363636255264282)
                )
                8: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.072727270424366)
                )
                9: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.08181817829608917)
                )
                10: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.09090908616781235)
                )
                11: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.09999999403953552)
                )
            )
        )
        ln_post: LayerNorm((768,), 1e-05, elementwise_affine=True)
        prompt_proj: Linear(768, 768, float32[768,], None)
        prompt_norm: LayerNorm((768,), 1e-06, elementwise_affine=True)
        prompt_dropout: Dropout(0.1, is_train=False)
    )
    decode_head: ATMSingleHeadSeg(
        loss_decode: CrossEntropyLoss(avg_non_ignore=False)
        dropout: Dropout(0.1, is_train=False)
        input_proj_1: Identity(None, None)
        proj_norm_1: Identity(None, None)
        decoder_q: TPN_Decoder(
            layers: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                1: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                2: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
        )
        decoder_v: TPN_Decoder(
            layers: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                1: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                2: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
        )
        recovery_decoder: RecoveryDecoder(
            decouple_q: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
            decouple_v: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
            linear_q_in: Linear(512, 512, float32[512,], None)
            linear_k_in: Linear(512, 512, float32[512,], None)
            linear_q_out: Linear(512, 1024, float32[1024,], None)
            linear_k_out: Linear(512, 512, float32[512,], None)
        )
        lateral_proj: Linear(1536, 512, float32[512,], None)
        q_proj: Linear(1024, 512, float32[512,], None)
    )
    text_encoder: CLIPTextEncoder(
        transformer: Transformer(
            resblocks: Sequential(
                0: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                1: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                2: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                3: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                4: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                5: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                6: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                7: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                8: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                9: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                10: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                11: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
            )
        )
        token_embedding: Embedding(49408, 512, None, dtype=None)
        ln_final: LayerNorm((512,), 1e-05, elementwise_affine=True)
    )
)
Making visible mask for zero-shot setting: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1 255]
--------------------------------------
Finetune layer in segmentor: backbone.prompt_embeddings
Finetune layer in segmentor: backbone.deep_prompt_embeddings
Finetune layer in segmentor: backbone.prompt_proj.weight
Finetune layer in segmentor: backbone.prompt_proj.bias
Finetune layer in segmentor: backbone.prompt_norm.weight
Finetune layer in segmentor: backbone.prompt_norm.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.linear1.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.linear2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm2.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm3.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm3.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.linear1.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.linear2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm2.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm3.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm3.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_q_in.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_k_in.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_q_out.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_k_out.bias
Finetune layer in segmentor: decode_head.lateral_proj.bias
Finetune layer in segmentor: decode_head.q_proj.bias
CLASSES: &id003 !!python/tuple
- aeroplane
- bicycle
- bird
- boat
- bottle
- bus
- car
- cat
- chair
- cow
- diningtable
- dog
- horse
- motorbike
- person
- pottedplant
- sheep
- sofa
- train
- tvmonitor
base: /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos
base_class:
- 0
- 1
- 2
- 3
- 4
- 5
- 6
- 7
- 8
- 9
- 10
- 11
- 12
- 13
- 14
base_scratch: /mnt/fast/nobackup/scratch4weeks/ae01116
both_class:
- 0
- 1
- 2
- 3
- 4
- 5
- 6
- 7
- 8
- 9
- 10
- 11
- 12
- 13
- 14
- 15
- 16
- 17
- 18
- 19
checkpoint_interval: 2000
crop_size: &id002 !!python/tuple
- 512
- 512
data:
  samples_per_gpu: 4
  test:
    ann_dir: SegmentationClass
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - flip: false
      img_scale: &id001 !!python/tuple
      - 2048
      - 512
      transforms:
      - keep_ratio: true
        min_size: 512
        type: Resize
      - type: RandomFlip
      - mean:
        - 123.675
        - 116.28
        - 103.53
        std:
        - 58.395
        - 57.12
        - 57.375
        to_rgb: true
        type: Normalize
      - keys:
        - img
        type: ImageToTensor
      - keys:
        - img
        type: Collect
      type: MultiScaleFlipAug
    split: ImageSets/Segmentation/val.txt
    type: ZeroPascalVOCDataset20
  train:
    ann_dir:
    - SegmentationClass
    - SegmentationClassAug
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - reduce_zero_label: true
      type: LoadAnnotations
    - img_scale: *id001
      ratio_range: &id004 !!python/tuple
      - 0.5
      - 2.0
      type: Resize
    - cat_max_ratio: 0.75
      crop_size: *id002
      type: RandomCrop
    - prob: 0.5
      type: RandomFlip
    - type: PhotoMetricDistortion
    - mean:
      - 123.675
      - 116.28
      - 103.53
      std:
      - 58.395
      - 57.12
      - 57.375
      to_rgb: true
      type: Normalize
    - pad_val: 0
      seg_pad_val: 255
      size: *id002
      type: Pad
    - type: DefaultFormatBundle
    - keys:
      - img
      - gt_semantic_seg
      type: Collect
    split:
    - ImageSets/Segmentation/train.txt
    - ImageSets/Segmentation/aug.txt
    type: ZeroPascalVOCDataset20
  val:
    ann_dir: SegmentationClass
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - flip: false
      img_scale: *id001
      transforms:
      - keep_ratio: true
        min_size: 512
        type: Resize
      - type: RandomFlip
      - mean:
        - 123.675
        - 116.28
        - 103.53
        std:
        - 58.395
        - 57.12
        - 57.375
        to_rgb: true
        type: Normalize
      - keys:
        - img
        type: ImageToTensor
      - keys:
        - img
        type: Collect
      type: MultiScaleFlipAug
    split: ImageSets/Segmentation/val.txt
    type: ZeroPascalVOCDataset20
  workers_per_gpu: 4
data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
dataset_type: ZeroPascalVOCDataset20
eval_interval: 2000
img_norm_cfg:
  mean:
  - 123.675
  - 116.28
  - 103.53
  std:
  - 58.395
  - 57.12
  - 57.375
  to_rgb: true
img_size: 512
in_channels: 512
log_interval: 50
logger:
  type: RunLogger
max_iter: 40000
model:
  backbone:
    drop_path_rate: 0.1
    get_embeddings: true
    input_resolution: 512
    layers: 12
    num_tokens: 10
    out_indices:
    - 11
    output_dim: 512
    patch_size: 16
    prompt_dim: 768
    region_level_bridge_size: 16
    total_d_layer: 11
    type: CLIPVisionTransformerWithRLB
    width: 768
  base_class:
  - 0
  - 1
  - 2
  - 3
  - 4
  - 5
  - 6
  - 7
  - 8
  - 9
  - 10
  - 11
  - 12
  - 13
  - 14
  both_class:
  - 0
  - 1
  - 2
  - 3
  - 4
  - 5
  - 6
  - 7
  - 8
  - 9
  - 10
  - 11
  - 12
  - 13
  - 14
  - 15
  - 16
  - 17
  - 18
  - 19
  class_names: *id003
  decode_head:
    all_idx:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    - 6
    - 7
    - 8
    - 9
    - 10
    - 11
    - 12
    - 13
    - 14
    - 15
    - 16
    - 17
    - 18
    - 19
    channels: 512
    embed_dims: 512
    img_size: 512
    in_channels: 512
    num_classes: 15
    num_heads: 8
    num_layers: 3
    seen_idx:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    - 6
    - 7
    - 8
    - 9
    - 10
    - 11
    - 12
    - 13
    - 14
    type: ATMSingleHeadSeg
    use_proj: false
    use_stages: 1
  exclude_key: prompt
  ft_backbone: false
  load_text_embedding: /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos/configs/_base_/datasets/text_embedding/voc12_single.npy
  novel_class:
  - 15
  - 16
  - 17
  - 18
  - 19
  pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
  pretrained_text: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
  test_cfg:
    crop_size: !!python/tuple
    - 512
    - 512
    mode: slide
    stride: !!python/tuple
    - 426
    - 426
  text_encoder:
    context_length: 77
    embed_dim: 512
    pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
    transformer_heads: 8
    transformer_layers: 12
    transformer_width: 512
    type: CLIPTextEncoder
  type: CLIPRC
name: clip_rc_zero_vit-b_512x512_40k_voc_10_16
novel_class:
- 15
- 16
- 17
- 18
- 19
optimizer:
  betas: !!python/tuple
  - 0.9
  - 0.999
  lr: 2.0e-05
  type: CustomAdamW
  weight_decay: 0.01
out_indices:
- 11
parameter_groups_generator:
  custom_keys:
    backbone:
      lr_mult: 10.0
    head:
      lr_mult: 10.0
    ln:
      decay_mult: 0.0
    norm:
      decay_mult: 0.0
    text_encoder:
      lr_mult: 0.0
  type: CustomPrameterGroupsGenerator
pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
region_level_bridge_size: 16
scheduler:
  max_steps: 40000
  min_lr: 1.0e-06
  power: 0.9
  type: PolyLR
  warmup: linear
  warmup_iters: 1500
  warmup_ratio: 1.0e-06
test_pipeline:
- type: LoadImageFromFile
- flip: false
  img_scale: *id001
  transforms:
  - keep_ratio: true
    min_size: 512
    type: Resize
  - type: RandomFlip
  - mean:
    - 123.675
    - 116.28
    - 103.53
    std:
    - 58.395
    - 57.12
    - 57.375
    to_rgb: true
    type: Normalize
  - keys:
    - img
    type: ImageToTensor
  - keys:
    - img
    type: Collect
  type: MultiScaleFlipAug
train_pipeline:
- type: LoadImageFromFile
- reduce_zero_label: true
  type: LoadAnnotations
- img_scale: *id001
  ratio_range: *id004
  type: Resize
- cat_max_ratio: 0.75
  crop_size: *id002
  type: RandomCrop
- prob: 0.5
  type: RandomFlip
- type: PhotoMetricDistortion
- mean:
  - 123.675
  - 116.28
  - 103.53
  std:
  - 58.395
  - 57.12
  - 57.375
  to_rgb: true
  type: Normalize
- pad_val: 0
  seg_pad_val: 255
  size: *id002
  type: Pad
- type: DefaultFormatBundle
- keys:
  - img
  - gt_semantic_seg
  type: Collect
work_dir: work_dirs/clip_rc_zero_vit-b_512x512_40k_voc_10_16

Making visible mask for zero-shot setting: [  0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1  -1
  -1  -1  -1 255]
Thu Aug  1 11:04:57 2024  model:CLIPRC(
    backbone: CLIPVisionTransformerWithRLB(
        conv1: Conv(3, 768, (16, 16), (16, 16), (0, 0), (1, 1), 1, None, None, Kw=None, fan=None, i=None, bound=None)
        ln_pre: LayerNorm((768,), 1e-05, elementwise_affine=True)
        transformer: Transformer(
            resblocks: Sequential(
                0: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                1: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.00909090880304575)
                )
                2: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.0181818176060915)
                )
                3: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.027272727340459824)
                )
                4: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.036363635212183)
                )
                5: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.045454543083906174)
                )
                6: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.05454545468091965)
                )
                7: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.06363636255264282)
                )
                8: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.072727270424366)
                )
                9: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.08181817829608917)
                )
                10: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.09090908616781235)
                )
                11: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.09999999403953552)
                )
            )
        )
        ln_post: LayerNorm((768,), 1e-05, elementwise_affine=True)
        prompt_proj: Linear(768, 768, float32[768,], None)
        prompt_norm: LayerNorm((768,), 1e-06, elementwise_affine=True)
        prompt_dropout: Dropout(0.1, is_train=False)
    )
    decode_head: ATMSingleHeadSeg(
        loss_decode: CrossEntropyLoss(avg_non_ignore=False)
        dropout: Dropout(0.1, is_train=False)
        input_proj_1: Identity(None, None)
        proj_norm_1: Identity(None, None)
        decoder_q: TPN_Decoder(
            layers: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                1: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                2: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
        )
        decoder_v: TPN_Decoder(
            layers: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                1: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                2: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
        )
        recovery_decoder: RecoveryDecoder(
            decouple_q: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
            decouple_v: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
            linear_q_in: Linear(512, 512, float32[512,], None)
            linear_k_in: Linear(512, 512, float32[512,], None)
            linear_q_out: Linear(512, 1024, float32[1024,], None)
            linear_k_out: Linear(512, 512, float32[512,], None)
        )
        lateral_proj: Linear(1536, 512, float32[512,], None)
        q_proj: Linear(1024, 512, float32[512,], None)
    )
    text_encoder: CLIPTextEncoder(
        transformer: Transformer(
            resblocks: Sequential(
                0: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                1: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                2: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                3: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                4: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                5: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                6: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                7: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                8: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                9: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                10: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                11: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
            )
        )
        token_embedding: Embedding(49408, 512, None, dtype=None)
        ln_final: LayerNorm((512,), 1e-05, elementwise_affine=True)
    )
)
--------------------------------------
Finetune layer in segmentor: backbone.prompt_embeddings
Finetune layer in segmentor: backbone.deep_prompt_embeddings
Finetune layer in segmentor: backbone.prompt_proj.weight
Finetune layer in segmentor: backbone.prompt_proj.bias
Finetune layer in segmentor: backbone.prompt_norm.weight
Finetune layer in segmentor: backbone.prompt_norm.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.0.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.1.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.1.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.linear1.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.linear2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm2.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm2.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm3.weight
Finetune layer in segmentor: decode_head.decoder_q.layers.2.norm3.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_q.layers.2.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.0.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.1.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.1.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.linear1.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.linear2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm2.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm2.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm3.weight
Finetune layer in segmentor: decode_head.decoder_v.layers.2.norm3.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.decoder_v.layers.2.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.linear1.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.linear2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm2.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm3.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.norm3.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_q.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.linear1.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.linear2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm2.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm2.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm3.weight
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.norm3.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.q.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.k.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.v.bias
Finetune layer in segmentor: decode_head.recovery_decoder.decouple_v.0.multihead_attn.proj.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_q_in.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_k_in.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_q_out.bias
Finetune layer in segmentor: decode_head.recovery_decoder.linear_k_out.bias
Finetune layer in segmentor: decode_head.lateral_proj.bias
Finetune layer in segmentor: decode_head.q_proj.bias
CLASSES: &id003 !!python/tuple
- aeroplane
- bicycle
- bird
- boat
- bottle
- bus
- car
- cat
- chair
- cow
- diningtable
- dog
- horse
- motorbike
- person
- pottedplant
- sheep
- sofa
- train
- tvmonitor
base: /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos
base_class:
- 0
- 1
- 2
- 3
- 4
- 5
- 6
- 7
- 8
- 9
- 10
- 11
- 12
- 13
- 14
base_scratch: /mnt/fast/nobackup/scratch4weeks/ae01116
both_class:
- 0
- 1
- 2
- 3
- 4
- 5
- 6
- 7
- 8
- 9
- 10
- 11
- 12
- 13
- 14
- 15
- 16
- 17
- 18
- 19
checkpoint_interval: 2000
crop_size: &id002 !!python/tuple
- 512
- 512
data:
  samples_per_gpu: 4
  test:
    ann_dir: SegmentationClass
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - flip: false
      img_scale: &id001 !!python/tuple
      - 2048
      - 512
      transforms:
      - keep_ratio: true
        min_size: 512
        type: Resize
      - type: RandomFlip
      - mean:
        - 123.675
        - 116.28
        - 103.53
        std:
        - 58.395
        - 57.12
        - 57.375
        to_rgb: true
        type: Normalize
      - keys:
        - img
        type: ImageToTensor
      - keys:
        - img
        type: Collect
      type: MultiScaleFlipAug
    split: ImageSets/Segmentation/val.txt
    type: ZeroPascalVOCDataset20
  train:
    ann_dir:
    - SegmentationClass
    - SegmentationClassAug
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - reduce_zero_label: true
      type: LoadAnnotations
    - img_scale: *id001
      ratio_range: &id004 !!python/tuple
      - 0.5
      - 2.0
      type: Resize
    - cat_max_ratio: 0.75
      crop_size: *id002
      type: RandomCrop
    - prob: 0.5
      type: RandomFlip
    - type: PhotoMetricDistortion
    - mean:
      - 123.675
      - 116.28
      - 103.53
      std:
      - 58.395
      - 57.12
      - 57.375
      to_rgb: true
      type: Normalize
    - pad_val: 0
      seg_pad_val: 255
      size: *id002
      type: Pad
    - type: DefaultFormatBundle
    - keys:
      - img
      - gt_semantic_seg
      type: Collect
    split:
    - ImageSets/Segmentation/train.txt
    - ImageSets/Segmentation/aug.txt
    type: ZeroPascalVOCDataset20
  val:
    ann_dir: SegmentationClass
    data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
    img_dir: JPEGImages
    pipeline:
    - type: LoadImageFromFile
    - flip: false
      img_scale: *id001
      transforms:
      - keep_ratio: true
        min_size: 512
        type: Resize
      - type: RandomFlip
      - mean:
        - 123.675
        - 116.28
        - 103.53
        std:
        - 58.395
        - 57.12
        - 57.375
        to_rgb: true
        type: Normalize
      - keys:
        - img
        type: ImageToTensor
      - keys:
        - img
        type: Collect
      type: MultiScaleFlipAug
    split: ImageSets/Segmentation/val.txt
    type: ZeroPascalVOCDataset20
  workers_per_gpu: 4
data_root: /mnt/fast/nobackup/scratch4weeks/ae01116/data/VOC2012
dataset_type: ZeroPascalVOCDataset20
eval_interval: 2000
img_norm_cfg:
  mean:
  - 123.675
  - 116.28
  - 103.53
  std:
  - 58.395
  - 57.12
  - 57.375
  to_rgb: true
img_size: 512
in_channels: 512
log_interval: 50
logger:
  type: RunLogger
max_iter: 40000
model:
  backbone:
    drop_path_rate: 0.1
    get_embeddings: true
    input_resolution: 512
    layers: 12
    num_tokens: 10
    out_indices:
    - 11
    output_dim: 512
    patch_size: 16
    prompt_dim: 768
    region_level_bridge_size: 16
    total_d_layer: 11
    type: CLIPVisionTransformerWithRLB
    width: 768
  base_class:
  - 0
  - 1
  - 2
  - 3
  - 4
  - 5
  - 6
  - 7
  - 8
  - 9
  - 10
  - 11
  - 12
  - 13
  - 14
  both_class:
  - 0
  - 1
  - 2
  - 3
  - 4
  - 5
  - 6
  - 7
  - 8
  - 9
  - 10
  - 11
  - 12
  - 13
  - 14
  - 15
  - 16
  - 17
  - 18
  - 19
  class_names: *id003
  decode_head:
    all_idx:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    - 6
    - 7
    - 8
    - 9
    - 10
    - 11
    - 12
    - 13
    - 14
    - 15
    - 16
    - 17
    - 18
    - 19
    channels: 512
    embed_dims: 512
    img_size: 512
    in_channels: 512
    num_classes: 15
    num_heads: 8
    num_layers: 3
    seen_idx:
    - 0
    - 1
    - 2
    - 3
    - 4
    - 5
    - 6
    - 7
    - 8
    - 9
    - 10
    - 11
    - 12
    - 13
    - 14
    type: ATMSingleHeadSeg
    use_proj: false
    use_stages: 1
  exclude_key: prompt
  ft_backbone: false
  load_text_embedding: /mnt/fast/nobackup/users/ae01116/multi-modal-dissertation-uos/configs/_base_/datasets/text_embedding/voc12_single.npy
  novel_class:
  - 15
  - 16
  - 17
  - 18
  - 19
  pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
  pretrained_text: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
  test_cfg:
    crop_size: !!python/tuple
    - 512
    - 512
    mode: slide
    stride: !!python/tuple
    - 426
    - 426
  text_encoder:
    context_length: 77
    embed_dim: 512
    pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
    transformer_heads: 8
    transformer_layers: 12
    transformer_width: 512
    type: CLIPTextEncoder
  type: CLIPRC
name: clip_rc_zero_vit-b_512x512_40k_voc_10_16
novel_class:
- 15
- 16
- 17
- 18
- 19
optimizer:
  betas: !!python/tuple
  - 0.9
  - 0.999
  lr: 2.0e-05
  type: CustomAdamW
  weight_decay: 0.01
out_indices:
- 11
parameter_groups_generator:
  custom_keys:
    backbone:
      lr_mult: 10.0
    head:
      lr_mult: 10.0
    ln:
      decay_mult: 0.0
    norm:
      decay_mult: 0.0
    text_encoder:
      lr_mult: 0.0
  type: CustomPrameterGroupsGenerator
pretrained: /mnt/fast/nobackup/scratch4weeks/ae01116/weights/ViT-B-16-RC-CLIP.pkl
region_level_bridge_size: 16
scheduler:
  max_steps: 40000
  min_lr: 1.0e-06
  power: 0.9
  type: PolyLR
  warmup: linear
  warmup_iters: 1500
  warmup_ratio: 1.0e-06
test_pipeline:
- type: LoadImageFromFile
- flip: false
  img_scale: *id001
  transforms:
  - keep_ratio: true
    min_size: 512
    type: Resize
  - type: RandomFlip
  - mean:
    - 123.675
    - 116.28
    - 103.53
    std:
    - 58.395
    - 57.12
    - 57.375
    to_rgb: true
    type: Normalize
  - keys:
    - img
    type: ImageToTensor
  - keys:
    - img
    type: Collect
  type: MultiScaleFlipAug
train_pipeline:
- type: LoadImageFromFile
- reduce_zero_label: true
  type: LoadAnnotations
- img_scale: *id001
  ratio_range: *id004
  type: Resize
- cat_max_ratio: 0.75
  crop_size: *id002
  type: RandomCrop
- prob: 0.5
  type: RandomFlip
- type: PhotoMetricDistortion
- mean:
  - 123.675
  - 116.28
  - 103.53
  std:
  - 58.395
  - 57.12
  - 57.375
  to_rgb: true
  type: Normalize
- pad_val: 0
  seg_pad_val: 255
  size: *id002
  type: Pad
- type: DefaultFormatBundle
- keys:
  - img
  - gt_semantic_seg
  type: Collect
work_dir: work_dirs/clip_rc_zero_vit-b_512x512_40k_voc_10_16

Thu Aug  1 11:04:57 2024  model:CLIPRC(
    backbone: CLIPVisionTransformerWithRLB(
        conv1: Conv(3, 768, (16, 16), (16, 16), (0, 0), (1, 1), 1, None, None, Kw=None, fan=None, i=None, bound=None)
        ln_pre: LayerNorm((768,), 1e-05, elementwise_affine=True)
        transformer: Transformer(
            resblocks: Sequential(
                0: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                1: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.00909090880304575)
                )
                2: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.0181818176060915)
                )
                3: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.027272727340459824)
                )
                4: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.036363635212183)
                )
                5: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.045454543083906174)
                )
                6: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.05454545468091965)
                )
                7: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.06363636255264282)
                )
                8: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.072727270424366)
                )
                9: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.08181817829608917)
                )
                10: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.09090908616781235)
                )
                11: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(768, 768, float32[768,], None)
                    )
                    ln_1: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(768, 3072, float32[3072,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(3072, 768, float32[768,], None)
                    )
                    ln_2: LayerNorm((768,), 1e-05, elementwise_affine=True)
                    drop_path: DropPath(p=0.09999999403953552)
                )
            )
        )
        ln_post: LayerNorm((768,), 1e-05, elementwise_affine=True)
        prompt_proj: Linear(768, 768, float32[768,], None)
        prompt_norm: LayerNorm((768,), 1e-06, elementwise_affine=True)
        prompt_dropout: Dropout(0.1, is_train=False)
    )
    decode_head: ATMSingleHeadSeg(
        loss_decode: CrossEntropyLoss(avg_non_ignore=False)
        dropout: Dropout(0.1, is_train=False)
        input_proj_1: Identity(None, None)
        proj_norm_1: Identity(None, None)
        decoder_q: TPN_Decoder(
            layers: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                1: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                2: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
        )
        decoder_v: TPN_Decoder(
            layers: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                1: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
                2: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
        )
        recovery_decoder: RecoveryDecoder(
            decouple_q: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
            decouple_v: Sequential(
                0: TPN_DecoderLayer(
                    linear1: Linear(512, 2048, float32[2048,], None)
                    dropout: Dropout(0.1, is_train=False)
                    linear2: Linear(2048, 512, float32[512,], None)
                    norm2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    norm3: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    dropout1: Dropout(0.1, is_train=False)
                    dropout2: Dropout(0.1, is_train=False)
                    dropout3: Dropout(0.1, is_train=False)
                    multihead_attn: Attention(
                        q: Linear(512, 512, float32[512,], None)
                        k: Linear(512, 512, float32[512,], None)
                        v: Linear(512, 512, float32[512,], None)
                        attn_drop: Dropout(0.1, is_train=False)
                        proj: Linear(512, 512, float32[512,], None)
                        proj_drop: Dropout(0.0, is_train=False)
                    )
                )
            )
            linear_q_in: Linear(512, 512, float32[512,], None)
            linear_k_in: Linear(512, 512, float32[512,], None)
            linear_q_out: Linear(512, 1024, float32[1024,], None)
            linear_k_out: Linear(512, 512, float32[512,], None)
        )
        lateral_proj: Linear(1536, 512, float32[512,], None)
        q_proj: Linear(1024, 512, float32[512,], None)
    )
    text_encoder: CLIPTextEncoder(
        transformer: Transformer(
            resblocks: Sequential(
                0: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                1: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                2: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                3: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                4: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                5: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                6: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                7: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                8: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                9: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                10: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
                11: ResidualAttentionBlock(
                    attn: MultiheadAttention(
                        out_proj: Linear(512, 512, float32[512,], None)
                    )
                    ln_1: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    mlp: Sequential(
                        c_fc: Linear(512, 2048, float32[2048,], None)
                        gelu: QuickGELU(None, None)
                        c_proj: Linear(2048, 512, float32[512,], None)
                    )
                    ln_2: LayerNorm((512,), 1e-05, elementwise_affine=True)
                    drop_path: Identity(None, None)
                )
            )
        )
        token_embedding: Embedding(49408, 512, None, dtype=None)
        ln_final: LayerNorm((512,), 1e-05, elementwise_affine=True)
    )
)
Beginning training script
